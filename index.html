<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Multi-Service Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .service-tab {
            transition: all 0.3s ease;
        }
        
        .service-tab.active {
            border-color: currentColor;
            color: white;
        }
        
        /* Service specific colors */
        .airbnb-color { color: #FF5A5F; }
        .airbnb-bg { background-color: #FF5A5F; }
        .amazon-color { color: #FF9900; }
        .amazon-bg { background-color: #FF9900; }
        .glovo-color { color: #00A082; }
        .glovo-bg { background-color: #00A082; }
        .frecciarossa-color { color: #CC0033; }
        .frecciarossa-bg { background-color: #CC0033; }
        .lufthansa-color { color: #05164D; }
        .lufthansa-bg { background-color: #05164D; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center">
                <i class="fas fa-brain text-blue-600 text-3xl mr-2"></i>
                <span class="text-2xl font-bold text-blue-600">AI Multi-Service</span>
            </div>
            <nav class="hidden md:flex space-x-6">
                <a href="#" class="text-gray-700 hover:text-blue-600">Home</a>
                <a href="#" class="text-gray-700 hover:text-blue-600">Cronologia</a>
                <a href="#" class="text-gray-700 hover:text-blue-600">Preferiti</a>
                <a href="#" class="text-gray-700 hover:text-blue-600">Account</a>
                <a href="#" class="text-gray-700 hover:text-blue-600">Aiuto</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <!-- Service Selection -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold mb-6 text-center">Cosa vuoi fare oggi?</h1>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
                <button id="airbnb-tab" class="service-tab flex flex-col items-center justify-center p-4 rounded-lg border-2 border-transparent hover:border-[#FF5A5F] hover:bg-[#FF5A5F] hover:text-white transition-all">
                    <i class="fab fa-airbnb text-4xl mb-2 airbnb-color"></i>
                    <span>Alloggi</span>
                </button>
                <button id="amazon-tab" class="service-tab flex flex-col items-center justify-center p-4 rounded-lg border-2 border-transparent hover:border-[#FF9900] hover:bg-[#FF9900] hover:text-white transition-all">
                    <i class="fab fa-amazon text-4xl mb-2 amazon-color"></i>
                    <span>Shopping</span>
                </button>
                <button id="glovo-tab" class="service-tab flex flex-col items-center justify-center p-4 rounded-lg border-2 border-transparent hover:border-[#00A082] hover:bg-[#00A082] hover:text-white transition-all">
                    <i class="fas fa-utensils text-4xl mb-2 glovo-color"></i>
                    <span>Food</span>
                </button>
                <button id="frecciarossa-tab" class="service-tab flex flex-col items-center justify-center p-4 rounded-lg border-2 border-transparent hover:border-[#CC0033] hover:bg-[#CC0033] hover:text-white transition-all">
                    <i class="fas fa-train text-4xl mb-2 frecciarossa-color"></i>
                    <span>Treni</span>
                </button>
                <button id="lufthansa-tab" class="service-tab flex flex-col items-center justify-center p-4 rounded-lg border-2 border-transparent hover:border-[#05164D] hover:bg-[#05164D] hover:text-white transition-all">
                    <i class="fas fa-plane text-4xl mb-2 lufthansa-color"></i>
                    <span>Voli</span>
                </button>
            </div>
        </div>

        <!-- Search Section -->
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Left Side - AI Search -->
            <div class="lg:w-1/3">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div id="service-icon-container" class="flex justify-center mb-4">
                        <i id="service-icon" class="fab fa-airbnb text-5xl airbnb-color"></i>
                    </div>
                    <h2 id="search-title" class="text-xl font-bold mb-4 text-center">Cerca alloggi con AI</h2>
                    <p class="text-gray-600 mb-4">Descrivi cosa stai cercando usando linguaggio naturale e l'AI ti aiuterà a trovare le migliori opzioni:</p>
                    
                    <div class="mb-4">
                        <textarea id="aiPrompt" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="4" placeholder="Es: Cerco un appartamento a Firenze vicino al centro per 2 persone con terrazza"></textarea>
                    </div>
                    
                    <button id="searchButton" class="w-full bg-[#FF5A5F] text-white py-3 rounded-lg font-semibold hover:opacity-90 transition">
                        <i class="fas fa-search mr-2"></i>Cerca con DeepSeek AI
                    </button>
                    
                    <div id="loading" class="loader hidden"></div>
                    
                    <div id="aiSuggestion" class="mt-4 p-4 bg-gray-50 rounded-lg hidden">
                        <h3 class="font-bold mb-2">L'AI ha capito:</h3>
                        <div id="aiUnderstanding" class="text-gray-700"></div>
                    </div>
                </div>
            </div>
            
            <!-- Right Side - Results -->
            <div class="lg:w-2/3">
                <div id="resultsContainer" class="hidden">
                    <h2 id="results-title" class="text-2xl font-bold mb-6">Risultati della ricerca</h2>
                    
                    <div id="results-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Results will be added here dynamically -->
                    </div>
                </div>
                
                <div id="initialMessage" class="bg-white p-8 rounded-lg shadow-md text-center">
                    <i class="fas fa-brain text-blue-600 text-5xl mb-4"></i>
                    <h2 class="text-2xl font-bold mb-3">Assistente AI Multi-Servizio</h2>
                    <p class="text-gray-600 mb-6">Seleziona un servizio e descrivi cosa stai cercando usando il linguaggio naturale. L'intelligenza artificiale DeepSeek ti aiuterà a trovare ciò di cui hai bisogno.</p>
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4 text-sm">
                        <div class="p-2 border rounded-lg">
                            <div class="text-[#FF5A5F] font-bold">Airbnb</div>
                            <div class="text-gray-500">Alloggi e case vacanza</div>
                        </div>
                        <div class="p-2 border rounded-lg">
                            <div class="text-[#FF9900] font-bold">Amazon</div>
                            <div class="text-gray-500">Prodotti e shopping</div>
                        </div>
                        <div class="p-2 border rounded-lg">
                            <div class="text-[#00A082] font-bold">Glovo</div>
                            <div class="text-gray-500">Cibo e consegne</div>
                        </div>
                        <div class="p-2 border rounded-lg">
                            <div class="text-[#CC0033] font-bold">Frecciarossa</div>
                            <div class="text-gray-500">Viaggi in treno</div>
                        </div>
                        <div class="p-2 border rounded-lg">
                            <div class="text-[#05164D] font-bold">Lufthansa</div>
                            <div class="text-gray-500">Voli e biglietti aerei</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Payment Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-xl font-bold">Conferma prenotazione</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="itemDetails" class="mb-4">
                <!-- Item details will be added here -->
            </div>
            
            <div class="border-t border-gray-200 py-4 mb-4">
                <div class="flex justify-between mb-2">
                    <span id="price-label">Prezzo base</span>
                    <span id="basePrice"></span>
                </div>
                <div class="flex justify-between mb-2" id="tax-container">
                    <span id="tax-label">Tasse e spese</span>
                    <span id="taxes"></span>
                </div>
                <div class="flex justify-between font-bold">
                    <span>Totale</span>
                    <span id="totalPrice"></span>
                </div>
            </div>
            
            <div class="mb-4">
                <h4 class="font-bold mb-2">Scegli metodo di pagamento</h4>
                <div class="flex gap-3 mb-4">
                    <button id="paypalButton" class="flex-1 border border-gray-300 p-3 rounded-lg flex items-center justify-center bg-[#0070BA] text-white hover:bg-[#005ea6]">
                        <i class="fab fa-paypal mr-2"></i> PayPal
                    </button>
                    <button id="creditCardButton" class="flex-1 border border-gray-300 p-3 rounded-lg flex items-center justify-center hover:bg-gray-50">
                        <i class="far fa-credit-card mr-2"></i> Carta
                    </button>
                </div>
            </div>
            
            <button id="confirmButton" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                Conferma e procedi
            </button>
        </div>
    </div>

    <script>
        // Current service state
        let currentService = 'airbnb';
        
        // Service configurations
        const serviceConfig = {
            airbnb: {
                name: 'Airbnb',
                icon: 'fab fa-airbnb',
                color: '#FF5A5F',
                title: 'Cerca alloggi con AI',
                resultTitle: 'Alloggi disponibili',
                promptPlaceholder: 'Es: Cerco un appartamento a Firenze vicino al centro per 2 persone con terrazza',
                modalTitle: 'Conferma prenotazione alloggio',
                priceLabel: 'Prezzo per notte',
                taxLabel: 'Tasse e pulizie',
                showTax: true,
                systemPrompt: "Sei un assistente che aiuta a interpretare le richieste degli utenti per la ricerca di alloggi su Airbnb. Analizza la richiesta dell'utente ed estrai le informazioni rilevanti come: località, numero di ospiti, budget, date, e caratteristiche desiderate. Rispondi in formato JSON con i seguenti campi: 'understanding' (riepilogo della richiesta) e 'filters' (oggetto con i filtri estratti)."
            },
            amazon: {
                name: 'Amazon',
                icon: 'fab fa-amazon',
                color: '#FF9900',
                title: 'Cerca prodotti con AI',
                resultTitle: 'Prodotti trovati',
                promptPlaceholder: 'Es: Sto cercando un buon laptop per lavoro di grafica sotto i 1000 euro con SSD ampio',
                modalTitle: 'Conferma acquisto',
                priceLabel: 'Prezzo prodotto',
                taxLabel: 'Spese di spedizione',
                showTax: true,
                systemPrompt: "Sei un assistente che aiuta a interpretare le richieste degli utenti per trovare prodotti su Amazon. Analizza la richiesta dell'utente ed estrai le informazioni rilevanti come: categoria di prodotto, prezzo massimo, caratteristiche, marca preferita. Rispondi in formato JSON con i seguenti campi: 'understanding' (riepilogo della richiesta) e 'filters' (oggetto con i filtri estratti)."
            },
            glovo: {
                name: 'Glovo',
                icon: 'fas fa-utensils',
                color: '#00A082',
                title: 'Cerca cibo con AI',
                resultTitle: 'Ristoranti e piatti disponibili',
                promptPlaceholder: 'Es: Vorrei ordinare una pizza margherita e un tiramisù con consegna entro un\'ora',
                modalTitle: 'Conferma ordine',
                priceLabel: 'Totale ordine',
                taxLabel: 'Spese di consegna',
                showTax: true,
                systemPrompt: "Sei un assistente che aiuta a interpretare le richieste degli utenti per ordinare cibo con Glovo. Analizza la richiesta dell'utente ed estrai le informazioni rilevanti come: tipo di cucina, piatti specifici, orario di consegna, preferenze dietetiche. Rispondi in formato JSON con i seguenti campi: 'understanding' (riepilogo della richiesta) e 'filters' (oggetto con i filtri estratti)."
            },
            frecciarossa: {
                name: 'Frecciarossa',
                icon: 'fas fa-train',
                color: '#CC0033',
                title: 'Cerca treni con AI',
                resultTitle: 'Treni disponibili',
                promptPlaceholder: 'Es: Mi serve un treno da Milano a Roma domani mattina in prima classe',
                modalTitle: 'Conferma prenotazione treno',
                priceLabel: 'Prezzo biglietto',
                taxLabel: 'Supplementi e prenotazioni',
                showTax: true,
                systemPrompt: "Sei un assistente che aiuta a interpretare le richieste degli utenti per prenotare viaggi in treno con Frecciarossa. Analizza la richiesta dell'utente ed estrai le informazioni rilevanti come: stazione di partenza, destinazione, data e ora, classe preferita. Rispondi in formato JSON con i seguenti campi: 'understanding' (riepilogo della richiesta) e 'filters' (oggetto con i filtri estratti)."
            },
            lufthansa: {
                name: 'Lufthansa',
                icon: 'fas fa-plane',
                color: '#05164D',
                title: 'Cerca voli con AI',
                resultTitle: 'Voli disponibili',
                promptPlaceholder: 'Es: Cerco un volo Milano-Berlino per il prossimo weekend, possibilmente con un solo bagaglio a mano',
                modalTitle: 'Conferma prenotazione volo',
                priceLabel: 'Prezzo volo',
                taxLabel: 'Tasse aeroportuali',
                showTax: true,
                systemPrompt: "Sei un assistente che aiuta a interpretare le richieste degli utenti per prenotare voli con Lufthansa. Analizza la richiesta dell'utente ed estrai le informazioni rilevanti come: aeroporto di partenza, destinazione, date, numero di passeggeri, classe preferita, bagagli. Rispondi in formato JSON con i seguenti campi: 'understanding' (riepilogo della richiesta) e 'filters' (oggetto con i filtri estratti)."
            }
        };
        
        // Mock data for services
        const mockData = {
            airbnb: [
                {
                    id: 1,
                    name: "Elegante appartamento nel centro di Firenze",
                    description: "Splendido appartamento con vista sul Duomo, a pochi passi dai principali punti di interesse",
                    price: 145,
                    rating: 4.9,
                    reviews: 127,
                    location: "Centro storico, Firenze",
                    image: "/api/placeholder/400/300",
                    host: "Marco",
                    features: ["2 ospiti", "1 camera da letto", "1 bagno", "Wi-Fi", "Cucina", "Terrazza"]
                },
                {
                    id: 2,
                    name: "Loft moderno vicino a Ponte Vecchio",
                    description: "Loft completamente ristrutturato con vista sull'Arno, posizione ideale per esplorare la città",
                    price: 135,
                    rating: 4.7,
                    reviews: 98,
                    location: "Oltrarno, Firenze",
                    image: "/api/placeholder/400/300",
                    host: "Laura",
                    features: ["2 ospiti", "Studio", "1 bagno", "Wi-Fi", "Cucina", "Aria condizionata"]
                },
                {
                    id: 3,
                    name: "Appartamento con terrazza panoramica",
                    description: "Luminoso appartamento con terrazza privata e vista mozzafiato sulla città e le colline toscane",
                    price: 150,
                    rating: 4.8,
                    reviews: 156,
                    location: "San Niccolò, Firenze",
                    image: "/api/placeholder/400/300",
                    host: "Giulia",
                    features: ["2 ospiti", "1 camera da letto", "1 bagno", "Wi-Fi", "Cucina", "Terrazza"]
                },
                {
                    id: 4,
                    name: "Accogliente studio nel Quartiere Santo Spirito",
                    description: "Grazioso monolocale in zona tranquilla ma centrale, perfetto per coppie",
                    price: 120,
                    rating: 4.6,
                    reviews: 89,
                    location: "Santo Spirito, Firenze",
                    image: "/api/placeholder/400/300",
                    host: "Andrea",
                    features: ["2 ospiti", "Studio", "1 bagno", "Wi-Fi", "Angolo cottura"]
                }
            ],
            amazon: [
                {
                    id: 1,
                    name: "Dell XPS 15 - Laptop per grafica professionale",
                    description: "Processore Intel i7, 16GB RAM, 1TB SSD, NVIDIA GeForce RTX 3050, display 15.6\" 4K",
                    price: 1799,
                    rating: 4.7,
                    reviews: 843,
                    image: "/api/placeholder/400/300",
                    seller: "Dell Official Store",
                    features: ["Intel i7", "16GB RAM", "1TB SSD", "NVIDIA RTX 3050", "Display 4K", "Windows 11"]
                },
                {
                    id: 2,
                    name: "MacBook Pro 14\" M2 Pro",
                    description: "Chip Apple M2 Pro, 16GB RAM, 512GB SSD, display Liquid Retina XDR da 14,2 pollici",
                    price: 2149,
                    rating: 4.9,
                    reviews: 1267,
                    image: "/api/placeholder/400/300",
                    seller: "Apple Store",
                    features: ["M2 Pro", "16GB RAM", "512GB SSD", "Display Retina XDR", "macOS"]
                },
                {
                    id: 3,
                    name: "Asus ProArt StudioBook 16",
                    description: "AMD Ryzen 9, 32GB RAM, 1TB SSD, NVIDIA GeForce RTX 3070, display 16\" OLED",
                    price: 2499,
                    rating: 4.8,
                    reviews: 412,
                    image: "/api/placeholder/400/300",
                    seller: "ASUS Official",
                    features: ["Ryzen 9", "32GB RAM", "1TB SSD", "RTX 3070", "Display OLED", "Dial Creator"]
                },
                {
                    id: 4,
                    name: "Acer ConceptD 5",
                    description: "Intel i7, 16GB RAM, 1TB SSD, NVIDIA GeForce RTX 3060, display 16\" 4K",
                    price: 1899,
                    rating: 4.6,
                    reviews: 237,
                    image: "/api/placeholder/400/300",
                    seller: "Acer Store",
                    features: ["Intel i7", "16GB RAM", "1TB SSD", "RTX 3060", "Display 4K", "Windows 11"]
                }
            ],
            glovo: [
                {
                    id: 1,
                    name: "Pizzeria Napoli Vera",
                    description: "Pizzeria tradizionale napoletana con impasto a lunga lievitazione",
                    price: 25,
                    rating: 4.8,
                    reviews: 543,
                    location: "Via Roma 34",
                    image: "/api/placeholder/400/300",
                    deliveryTime: "30-45 min",
                    menu: ["Pizza Margherita", "Pizza Marinara", "Pizza Diavola", "Tiramisù", "Bibite"]
                },
                {
                    id: 2,
                    name: "Pasta & Co",
                    description: "Pasta fresca fatta a mano e specialità italiane",
                    price: 32,
                    rating: 4.7,
                    reviews: 398,
                    location: "Corso Italia 12",
                    image: "/api/placeholder/400/300",
                    deliveryTime: "35-50 min",
                    menu: ["Carbonara", "Lasagna", "Ravioli", "Panna cotta", "Vini"]
                },
                {
                    id: 3,
                    name: "Sushi House",
                    description: "Autentico sushi giapponese preparato da chef esperti",
                    price: 38,
                    rating: 4.9,
                    reviews: 876,
                    location: "Via Verdi 56",
                    image: "/api/placeholder/400/300",
                    deliveryTime: "40-55 min",
                    menu: ["Nigiri Mix", "Uramaki", "Sashimi", "Mochi", "Sake"]
                },
                {
                    id: 4,
                    name: "Burger Lab",
                    description: "Hamburger gourmet con carne 100% italiana e ingredienti freschi",
                    price: 28,
                    rating: 4.6,
                    reviews: 451,
                    location: "Piazza Dante 7",
                    image: "/api/placeholder/400/300",
                    deliveryTime: "25-40 min",
                    menu: ["Classic Burger", "Cheese Burger", "Vegan Burger", "Patatine", "Milkshake"]
                }
            ],
            frecciarossa: [
                {
                    id: 1,
                    name: "Frecciarossa 1000",
                    description: "Milano Centrale - Roma Termini, diretto senza fermate intermedie",
                    price: 89,
                    rating: 4.7,
                    reviews: 1243,
                    departure: "Milano Centrale",
                    arrival: "Roma Termini",
                    image: "/api/placeholder/400/300",
                    departureTime: "08:30",
                    arrivalTime: "11:40",
                    features: ["Business", "Wi-Fi gratuito", "Ristorazione", "Prese elettriche", "Silenzio"]
                },
                {
                    id: 2,
                    name: "Frecciarossa 1000",
                    description: "Milano Centrale - Roma Termini, con fermate a Bologna e Firenze",
                    price: 79,
                    rating: 4.5,
                    reviews: 968,
                    departure: "Milano Centrale",
                    arrival: "Roma Termini",
                    image: "/api/placeholder/400/300",
                    departureTime: "10:15",
                    arrivalTime: "13:55",
                    features: ["Standard", "Wi-Fi gratuito", "Bar", "Prese elettriche"]
                },
                {
                    id: 3,
                    name: "Frecciarossa 1000",
                    description: "Milano Centrale - Roma Termini, diretto senza fermate intermedie",
                    price: 95,
                    rating: 4.8,
                    reviews: 1432,
                    departure: "Milano Centrale",
                    arrival: "Roma Termini",
                    image: "/api/placeholder/400/300",
                    departureTime: "12:00",
                    arrivalTime: "15:10",
                    features: ["Executive", "Wi-Fi gratuito", "Ristorazione al posto", "Prese elettriche", "Silenzio"]
                },
                {
                    id: 4,
                    name: "Frecciarossa 1000",
                    description: "Milano Centrale - Roma Termini, con fermata a Firenze",
                    price: 85,
                    rating: 4.6,
                    reviews: 1089,
                    departure: "Milano Centrale",
                    arrival: "Roma Termini",
                    image: "/api/placeholder/400/300",
                    departureTime: "14:30",
                    arrivalTime: "17:55",
                    features: ["Prima", "Wi-Fi gratuito", "Bar", "Prese elettriche", "Area break"]
                }
            ],
            lufthansa: [
                {
                    id: 1,
                    name: "LH1234",
                    description: "Milano Malpensa (MXP) - Berlino (BER), volo diretto",
                    price: 189,
                    rating: 4.6,
                    reviews: 876,
                    departure: "Milano Malpensa",
                    arrival: "Berlino Brandenburg",
                    image: "/api/placeholder/400/300",
                    departureTime: "07:30",
                    arrivalTime: "09:20",
                    features: ["Economy", "Bagaglio a mano", "Pasto", "Intrattenimento"]
                },
                {
                    id: 2,
                    name: "LH1434",
                    description: "Milano Malpensa (MXP) - Berlino (BER), volo diretto",
                    price: 249,
                    rating: 4.7,
                    reviews: 723,
                    departure: "Milano Malpensa",
                    arrival: "Berlino Brandenburg",
                    image: "/api/placeholder/400/300",
                    departureTime: "12:15",
                    arrivalTime: "14:05",
                    features: ["Economy Premium", "Bagaglio a mano", "Bagaglio da stiva 23kg", "Pasto premium"]
                },
                {
                    id: 3,
                    name: "LH5678",
                    description: "Milano Malpensa (MXP) - Berlino (BER), con scalo a Monaco",
                    price: 159,
                    rating: 4.4,
                    reviews: 542,
                    departure: "Milano Malpensa",
